(function(t){function e(e){for(var r,n,o=e[0],c=e[1],u=e[2],d=0,h=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&h.push(i[n][0]),i[n]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(h.length)h.shift()();return a.push.apply(a,u||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],r=!0,o=1;o<s.length;o++){var c=s[o];0!==i[c]&&(r=!1)}r&&(a.splice(e--,1),t=n(n.s=s[0]))}return t}var r={},i={app:0},a=[];function n(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=r,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/murderer/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var r=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"header"},[s("div",[s("img",{staticClass:"user__avatar",attrs:{src:"https://avatars.dicebear.com/api/micah/0.svg",alt:""}}),s("p",[t._v("Убийца (вы)")])]),s("p",[t._v("Незамеченных убийств: "+t._s(t.victimCount))])]),t.isGameActive?s("div",{staticClass:"list"},t._l(t.users,(function(e){return s("user-card",{key:e.id,attrs:{"is-game-over":t.isGameOver,user:e,users:t.users,"change-time":t.changeTime,"murderer-target":t.murdererTarget,"kill-mode":t.killMode},on:{"set-target":t.setUserTarget,"kill-user":t.killUser,"show-user":t.showUser}})})),1):s("div",{staticClass:"modal"},[s("div",{staticClass:"modal__blur"}),s("div",{staticClass:"modal__content"},[t.isGameOver?[s("h3",[t._v("Убийца пойман на месте преступления")]),s("p",[t._v("Незамеченных убийств: "+t._s(t.victimCount-1)+" ")]),s("div",{staticClass:"spectators"},t._l(t.spectators,(function(e){return s("div",{staticClass:"spectators__item"},[s("img",{staticClass:"avatar",attrs:{src:"https://avatars.dicebear.com/api/micah/"+e.id+".svg",alt:""}}),s("p",[t._v("User "+t._s(e.id))])])})),0)]:t._e(),t.isGameWin?[s("h3",[t._v("Вы победили!")]),s("p",[t._v("Убийства остались незамеченными")]),s("div",{staticClass:"spectators"},[s("div",{staticClass:"spectators__item"},[s("img",{staticClass:"avatar",attrs:{src:"https://avatars.dicebear.com/api/micah/0.svg",alt:""}}),s("p",[t._v("Победитель")])])])]:t._e(),s("button",{staticClass:"button",on:{click:t.startNewGame}},[t._v("Начать заново")])],2)])])},a=[],n=s("2909"),o=(s("d3b7"),s("3ca3"),s("ddb0"),s("2b3d"),s("ac1f"),s("841c"),s("99af"),s("d81d"),s("b64b"),s("a9e3"),s("c740"),s("a434"),s("4de4"),s("07ac"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user",class:{victim:t.user.isVictim,show:t.isShown},on:{click:t.showHandler}},[s("div",{staticClass:"user__images"},[s("div",{staticClass:"self"},[s("p",[t._v("User "+t._s(t.user.id))]),s("img",{staticClass:"avatar",attrs:{src:"https://avatars.dicebear.com/api/micah/"+t.user.id+".svg",alt:""}})]),t.user.target>=0&&t.isShown?s("div",{staticClass:"target"},[s("img",{staticClass:"avatar avatar--target",attrs:{src:"https://avatars.dicebear.com/api/micah/"+t.user.target+".svg",alt:""}}),s("p",[t._v(t._s(t.user.target?"User "+t.user.target:"Вы"))])]):t._e()]),s("div",{staticClass:"observers"},[t.isShown?s("div",{staticClass:"observers__list"},t._l(t.observers,(function(t){return s("img",{key:t.id,staticClass:"avatar",attrs:{src:"https://avatars.dicebear.com/api/micah/"+t.id+".svg",alt:""}})})),0):t._e()]),s("div",{staticClass:"toolbar"},[t.isButtonShown?s("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.killHandler.apply(null,arguments)}}},[t._v("Убить")]):t._e()])])}),c=[],u=(s("b680"),{name:"UserCard",props:{user:Object,users:Object,isGameOver:Boolean,murdererTarget:Number,changeTime:Number,killMode:String},data:function(){return{timer:null}},computed:{isShown:function(){return this.user.id===this.murdererTarget},observers:function(){var t=this;return Object.values(this.users).filter((function(e){return e.target===t.user.id}))},isButtonShown:function(){return"sight"===this.killMode?0===this.user.target&&this.isShown:this.isShown}},methods:{init:function(){this.$emit("set-target",this.user.id),this.intervalHandler()},intervalHandler:function(){var t=this,e=Math.floor(1e3*+(1+Math.random()*(this.changeTime-1)).toFixed(3));this.timer=setTimeout((function(){t.$emit("set-target",t.user.id),t.destroyTimer(),t.intervalHandler()}),e)},destroyTimer:function(){clearTimeout(this.timer)},killHandler:function(){this.destroyTimer(),this.$emit("kill-user",this.user.id)},showHandler:function(){this.$emit("show-user",this.user.id)}},mounted:function(){this.init()},beforeDestroy:function(){this.destroyTimer()}}),l=u,d=(s("fa35"),s("2877")),h=Object(d["a"])(l,o,c,!1,null,"4ad23e0e",null),m=h.exports,v={name:"App",components:{UserCard:m},data:function(){return{users:{},usersCount:8,changeTime:3,activeUsersIds:[],spectators:[],murdererTarget:null,killMode:"sight"}},mounted:function(){this.startNewGame()},computed:{victimCount:function(){return this.usersCount-this.activeUsersIds.length+1},isGameWin:function(){return!this.isGameOver&&2===this.activeUsersIds.length},isGameOver:function(){return!!this.spectators.length},isGameActive:function(){return!this.isGameOver&&!this.isGameWin}},methods:{startNewGame:function(){this.spectators=[],this.checkUrlParams(),this.initUsers()},checkUrlParams:function(){var t=new URLSearchParams(window.location.search);t.get("users")&&(this.usersCount=+t.get("users")),t.get("time")&&(this.changeTime=+t.get("time")),t.get("kill")&&(this.killMode=t.get("kill"))},initUsers:function(){for(var t={},e=1;e<=this.usersCount;e++)t[e]={id:e,target:0,isVictim:!1};this.activeUsersIds=[0].concat(Object(n["a"])(Object.keys(t).map(Number))),this.users=t},chooseRandomUserId:function(t){var e=Math.floor(Math.random()*this.activeUsersIds.length),s=this.activeUsersIds[e];return s===t?this.chooseRandomUserId(t):s},setUserTarget:function(t){this.users[t].target=this.chooseRandomUserId(t)},showUser:function(t){this.murdererTarget=t},killUser:function(t){var e=this.activeUsersIds.findIndex((function(e){return e===t}));this.murdererTarget=null,this.users[t].isVictim=!0,this.users[t].target=-1,this.activeUsersIds.splice(e,1),this.spectators=Object.values(this.users).filter((function(t){return 0===t.target}))}}},f=v,p=(s("7faf"),Object(d["a"])(f,i,a,!1,null,null,null)),g=p.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(g)}}).$mount("#app")},"609d":function(t,e,s){},"7faf":function(t,e,s){"use strict";s("b8ff")},b8ff:function(t,e,s){},fa35:function(t,e,s){"use strict";s("609d")}});
//# sourceMappingURL=app.6e795497.js.map